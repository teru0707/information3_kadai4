<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript技術解説 - 非同期処理の基礎と実践</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="#introduction">はじめに</a></li>
                <li><a href="#basics">基礎知識</a></li>
                <li><a href="#async">非同期処理</a></li>
                <li><a href="#practical">実践例</a></li>
            </ul>
        </nav>
        <h1>JavaScript非同期処理の基礎と実践</h1>
        <p>現代のWebアプリケーション開発に欠かせない非同期処理について詳しく解説します</p>
    </header>

    <main>
        <section id="introduction">
            <h2>はじめに</h2>
            <img src="JavaScript_logo.png" alt="JavaScript ロゴ" class="section-image">
            <p>JavaScriptは現代のWeb開発において最も重要な技術の一つです。特に非同期処理は、ユーザーエクスペリエンスを向上させるために不可欠な概念となっています。</p>
            <p>このページでは、JavaScriptの非同期処理について、基本的な概念から実践的な使用例まで幅広く解説します。Promise、async/await、そして実際のAPI呼び出しまで、段階的に学習していきましょう。</p>
            <img src="javascipt.png" alt="非同期処理の概念図" class="section-image" style="max-width: 350px; width: 100%; height: auto;">
        </section>

        <section id="basics">
            <h2>JavaScriptの基本構文と特徴</h2>
            <p>まず、JavaScriptの基本的な特徴について確認しましょう：</p>
            <ul>
                <li>動的型付け言語</li>
                <li>インタープリター言語</li>
                <li>プロトタイプベースのオブジェクト指向</li>
                <li>イベント駆動型プログラミング</li>
                <li>関数型プログラミングのサポート</li>
            </ul>
            
            <h3>基本的な変数宣言</h3>
            <div class="code-example" id="variable-example">
                <button onclick="showVariableExample()">変数宣言の例を表示</button>
                <div id="variable-output"></div>
            </div>
        </section>

        <section id="async">
            <h2>非同期処理（Promise、async/await）の解説</h2>
            <img src="promise_flow.png" alt="Promiseのフロー図" class="section-image" style="max-width: 350px; width: 100%; height: auto;">
            <p>非同期処理は、時間のかかる処理（APIリクエスト、ファイル読み込みなど）を実行する際に、メインスレッドをブロックしないようにする仕組みです。</p>
            
            <h3>Promiseとは</h3>
            <p>Promiseは非同期処理の結果を表すオブジェクトです。以下の3つの状態を持ちます：</p>
            <ol>
                <li><strong>Pending</strong>: 処理中</li>
                <li><strong>Fulfilled</strong>: 処理完了（成功）</li>
                <li><strong>Rejected</strong>: 処理完了（失敗）</li>
            </ol>

            <h3>async/awaitの使用例</h3>
            <div class="code-example">
                <button onclick="demonstrateAsyncAwait()">async/awaitのデモを実行</button>
                <div id="async-output"></div>
            </div>
        </section>

        <section id="practical">
            <h2>実践的な使用例</h2>
            <p>実際のWebアプリケーションでよく使用される非同期処理の例を見てみましょう。</p>
            
            <h3>APIからのデータ取得</h3>
            <div class="api-demo">
                <button onclick="fetchUserData()">ユーザーデータを取得</button>
                <div id="user-data-output"></div>
            </div>

            <h3>タイマー処理の実例</h3>
            <div class="timer-demo">
                <button onclick="startCountdown()">5秒カウントダウン開始</button>
                <div id="countdown-output"></div>
            </div>

            <h3>複数の非同期処理の制御</h3>
            <div class="multiple-async-demo">
                <button onclick="handleMultiplePromises()">複数のPromiseを並列実行</button>
                <div id="multiple-promises-output"></div>
            </div>
        </section>
    </main>

    <footer>
        <p>本コンテンツの作成時間（HTML/CSS/JavaScriptの設計・実装を含む）：約12時間</p>
        <p>2025 大阪公立大学工業高等専門学校 知能情報コース 3年Iコース 鳥谷尾晃暉</p>
        <p>最終更新：<span id="last-updated"></span></p>
        <p>
            <a href="https://developer.mozilla.org/ja/docs/Web/JavaScript" target="_blank">MDN JavaScript ドキュメント</a> |
            <a href="https://www.ct.omu.ac.jp/" target="_blank">大阪公立大学工業高等専門学校</a>
        </p>
    </footer>

    <script>
        // ページ読み込み時の初期化
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('last-updated').textContent = new Date().toLocaleString('ja-JP');
        });

        // 変数宣言の例を表示
        function showVariableExample() {
            const output = document.getElementById('variable-output');
            const examples = `
                <h4>変数宣言の種類</h4>
                <pre><code style="color: #222; font-weight: bold;">// let: ブロックスコープの変数
let userName = "鳥谷尾晃暉";
let age = 18;

// const: 定数（再代入不可）
const PI = 3.14159;
const university = "大阪公立大学工業高等専門学校";

// var: 関数スコープの変数（非推奨）
var oldStyle = "古い書き方";

console.log(\`こんにちは、\${userName}さん！年齢は\${age}歳ですね。\`);
                </code></pre>
            `;
            output.innerHTML = examples;
            
            // 実際にコンソールにも出力
            let userName = "鳥谷尾晃暉";
            let age = 18;
            console.log(`こんにちは、${userName}さん！年齢は${age}歳ですね。`);
        }

        // async/awaitのデモンストレーション
        async function demonstrateAsyncAwait() {
            const output = document.getElementById('async-output');
            output.innerHTML = '<p>非同期処理を実行中...</p>';
            
            try {
                // 疑似的な非同期処理
                const result1 = await simulateAsyncTask('データベース接続', 1000);
                output.innerHTML += `<p>✅ ${result1}</p>`;
                
                const result2 = await simulateAsyncTask('ユーザー認証', 800);
                output.innerHTML += `<p>✅ ${result2}</p>`;
                
                const result3 = await simulateAsyncTask('データ取得', 1200);
                output.innerHTML += `<p>✅ ${result3}</p>`;
                
                output.innerHTML += '<p><strong>すべての処理が完了しました！</strong></p>';
            } catch (error) {
                output.innerHTML += `<p>❌ エラーが発生しました: ${error.message}</p>`;
            }
        }

        // 疑似的な非同期タスク
        function simulateAsyncTask(taskName, delay) {
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    if (Math.random() > 0.1) { // 90%の確率で成功
                        resolve(`${taskName}が完了しました`);
                    } else {
                        reject(new Error(`${taskName}でエラーが発生しました`));
                    }
                }, delay);
            });
        }

        // APIからのデータ取得（JSONPlaceholder APIを使用）
        async function fetchUserData() {
            const output = document.getElementById('user-data-output');
            output.innerHTML = '<p>ユーザーデータを取得中...</p>';
            
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/users/1');
                let userData = await response.json();

                // ここでデータを書き換える
                userData.name = "鳥谷尾晃暉";
                userData.username = "teru0707";
                userData.email = "ro23089l@st.omu.ac.jp";
                userData.company.name = "大阪公立大学工業高等専門学校";
                userData.website = "https://www.ct.omu.ac.jp/";

                output.innerHTML = `
                    <div class="user-card">
                        <h4>ユーザー情報</h4>
                        <p><strong>名前:</strong> ${userData.name}</p>
                        <p><strong>ユーザー名:</strong> ${userData.username}</p>
                        <p><strong>メール:</strong> ${userData.email}</p>
                        <p><strong>会社:</strong> ${userData.company.name}</p>
                        <p><strong>ウェブサイト:</strong> <a href="http://${userData.website}" target="_blank">${userData.website}</a></p>
                    </div>
                `;
            } catch (error) {
                output.innerHTML = `<p>❌ データの取得に失敗しました: ${error.message}</p>`;
            }
        }

        // カウントダウンタイマー
        async function startCountdown() {
            const output = document.getElementById('countdown-output');
            
            for (let i = 5; i > 0; i--) {
                output.innerHTML = `<p class="countdown">⏰ ${i}秒</p>`;
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
            
            output.innerHTML = '<p class="countdown-complete">🎉 カウントダウン完了！</p>';
        }

        // 複数のPromiseの並列実行
        async function handleMultiplePromises() {
            const output = document.getElementById('multiple-promises-output');
            output.innerHTML = '<p>複数の非同期処理を並列実行中...</p>';
            
            const startTime = Date.now();
            
            try {
                // Promise.allを使用して並列実行
                const promises = [
                    simulateAsyncTask('タスク1', 1000),
                    simulateAsyncTask('タスク2', 1500),
                    simulateAsyncTask('タスク3', 800),
                    simulateAsyncTask('タスク4', 1200)
                ];
                
                const results = await Promise.all(promises);
                const endTime = Date.now();
                const duration = endTime - startTime;
                
                let resultHtml = '<h4>実行結果</h4>';
                results.forEach((result, index) => {
                    resultHtml += `<p>✅ ${result}</p>`;
                });
                resultHtml += `<p><strong>実行時間: ${duration}ms</strong></p>`;
                resultHtml += '<p>💡 Promise.allにより並列実行されました</p>';
                
                output.innerHTML = resultHtml;
                
            } catch (error) {
                output.innerHTML = `<p>❌ 一つ以上のタスクが失敗しました: ${error.message}</p>`;
            }
        }

        // スムーズスクロール機能
        document.querySelectorAll('nav a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // インタラクティブな要素のアニメーション
        function animateOnScroll() {
            const sections = document.querySelectorAll('section');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            });

            sections.forEach(section => {
                section.style.opacity = '0';
                section.style.transform = 'translateY(20px)';
                section.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                observer.observe(section);
            });
        }

        // ページ読み込み完了後にアニメーションを開始
        window.addEventListener('load', animateOnScroll);
    </script>
</body>
</html>
